<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.kb.star.util.UserCommentsDao">

    <insert id="insertCoordinate">
        INSERT INTO UserComments (X, Y, AbTestID, UserID, UserName)
        SELECT #{x}, #{y}, #{abTestId}, #{userId}, u.userName
        FROM Users u
        WHERE u.userID = #{userId}
    </insert>

    <insert id="insertComment">
        INSERT INTO UserComments (X, Y, AbTestID, UserID, UserName, CommentText)
        SELECT #{x}, #{y}, #{abTestId}, #{userId}, u.userName, #{commentText}
        FROM Users u
        WHERE u.userID = #{userId}
    </insert>

    <select id="getCommentsByAbTestId" resultType="com.kb.star.dto.UserCommentsDto">
        SELECT * FROM UserComments WHERE AbTestID=#{abTestId}
    </select>
</mapper>

